{
    "collab_server" : "",
    "contents" : "---\ntitle: |\n  | A Reference Guide to\n  | Gallup Advanced Analytics Projects (DRAFT)\nauthor: \"Bill Petti\"\ndate: \"December 2016\"\noutput:\n  html_document: default\n  pdf_document: default\n  word_document: default\n---\n\n# Introduction\n\nThe purpose of this document is to serve as a guide for consultants, partners, and other associates at Gallup responsible for selling and scoping project work with clients.\n\nAs our capabilities in Advanced Analytics and Predictive Modeling grows, so too does the need to understand the different types of projects that Gallup can execute with excellence.\n\nThe document provides examples of the most common types of projects, as well as some cautions and advice on questions to ask, scoping, and what makes these projects successful.  \n\n# Forecasting\n\n***Description and Examples***\n\nProbably the most common type of project that comes to mind when thinking about this work are forecasts. This is partly due to the inherent predictive nature of a forecast, but also because some of the most visible Gallup projects in this area have involved some kind of forecast work (e.g. forecasting tablet computer sales at Corning, mobile and smartphone sales, or passport applications for the State Department). These projects typically involve building models that predict some outcome, but do so at various time intervals in the future (i.e. a quarterly forecast for 3-, 6-, 9-, 12-, 18-months into the future).\n\nThe graph below shows a sample forecast where we've plotted sales in millions for some product, with actual sales from Q1 2015 to Q4 2016 and forecasted values thereafter out to Q2 2018:\n\n```{r, echo=FALSE, warning=FALSE, message=FALSE}\n\nrequire(tidyverse)\nrequire(scales)\nsource(\"https://raw.githubusercontent.com/BillPetti/R-Plotting-Resources/master/theme_gallup_md\")\ntheme_set(theme_gallup_md())\n\nforecast <- data_frame(Date = c(\"2015-1\", \"2015-2\", \"2015-3\", \"2015-4\", \"2016-1\", \"2016-2\", \"2016-3\", \"2016-4\", \"2017-1\", \"2017-2\", \"2017-3\", \"2017-4\", \"2018-1\", \"2018-2\"), Sales = c(123657, 138786, 135784, 170495, 134050, 145450, 110090, 156504, 123580, 144678, 139087, 167098, 132456, 147564))\n\nforecast_melt <- forecast %>%\n  gather(key = key, value = 'Sales in Millions', -Date)\n\nforecast_melt <- forecast_melt %>%\n  mutate(group = c(\"Actuals\", \"Actuals\", \"Actuals\", \"Actuals\", \n                   \"Actuals\", \"Actuals\", \"Actuals\", \"Actuals\", \n                   \"Forecast\", \"Forecast\", \"Forecast\", \"Forecast\", \n                   \"Forecast\", \"Forecast\"))\n\nforecast_melt %>%\n  ggplot(aes(x = Date, y = `Sales in Millions`, group = 1)) +\n  geom_point(color = \"#61C250\") +\n  geom_line(linetype = \"dashed\", color = \"#61C250\") +\n  geom_line(data = filter(forecast_melt, group == \"Actuals\"), color = \"#61C250\") +\n  xlab(\"\\nQuarter\") +\n  ylab(\"\\nSales in Millions\\n\") +\n  ggtitle(\"\\nExample: Actual & Forecasted Sales (MM)\\n\") +\n  scale_y_continuous(labels = scales::comma) + \n  theme(plot.title = element_text(size = 14, face = \"bold\"))\n```  \n\n#### Project Considerations\n\n***Data Availability***\n\n**Outcome Variable**\n\nWith any modeling project the key is to have a well-defined outcome to model to. This may sound obvious, but it hardly ever is. The first step is gaining clarity on exactly what the client would like us to forecast and what data will be used as the \"ground truth\" for the outcome. \n\nFor example, if a client says that they would like a forecast of consumer demand for smartphones across the globe there are dozens of ways to interpret that ask: is demand defined as consumers' intention to purchase a smartphone? If so, over what time frame? How do they define a smartphone? Is there a data set that includes historical, consistently collected consumer intentions?\n\nIf demand is actual sales versus intent to purchase, the same types of questions apply: What is the time frame of sales to be forecasted? Quarterly? Monthly? What is the ground truth for sales? There are many different services that compile sales data, so which one is to be used?\n\nOnce the definition of the outcome is settled on we need to understand whether their is a data source available for the outcome. Key questions for whether that data source will be appropriate for modeling include:\n\n* How far back does the data go?\n* At what level of analysis is the data? E.g. is it monthly, quarterly? And is it at the global, regional, or country level?\n* Has the data been consistently collected and calculated over the full history of the data source, or are there major breaks in methodology?\n* Will the data source be available in the future, or is it only available historically?\n\n**Features or Predictor Variables**\n\nAfter we've establish a definition for the outcome variable and identified a usable data set we next have to identify features for the model. The term \"feature\" is often used in machine learning, but it is essentially a synonym for \"predictor variable\", \"explanatory variable\", or \"independent variable\". Features are those variables that are used to predict the outcome we are interested in. \n\nFeature selection and engineering is a critical step in the forecasting process. \n\nThe graph below plots actual sales of mobile phones globally and compares the forecasts from IDC as well as two different versions from Gallup--one that uses our daily tracking data and one that does not:  \n\n```{r echo = FALSE, warning = FALSE, message = FALSE}\n\nsource(\"https://raw.githubusercontent.com/BillPetti/R-Plotting-Resources/master/gallup_palette.R\")\n\nmobile_forecast <- data_frame(Date = c(\"2016-1\", \"2016-2\", \"2016-3\"), `Actual Sales` = c(455926408, 469629927, 490512623), `IDC Forecast` = c(459599265, 467057822, 506150072), `Gallup Forecast (w/ Gallup Data)` = c(479037887, 466113890, 496272482), `Gallup Forecast (w/out Gallup Data)` = c(459607537, 432318744, 452081119), `Combined Gallup Forecast` = c(459607537, 466113890, 496272482))\n\nmobile_forecast_melt <- mobile_forecast %>%\n  gather(key = Forecast, value = sales, -Date)\n\nmobile_forecast_melt %>%\n  filter(Forecast != 'Combined Gallup Forecast') %>%\n  ggplot(aes(x = Date, y = sales, group = Forecast)) +\n  geom_point(aes(color = Forecast)) +\n  geom_line(aes(color = Forecast)) +\n  xlab(\"\\nQuarter\") +\n  ylab(\"\\nForecasted Sales in Millions\\n\") +\n  ggtitle(\"\\nExample: Mobile Phone Forecast\\n\") +\n  scale_color_manual(values = gallup_palette, \"\") +\n  scale_y_continuous(labels = scales::comma) + \n  theme(plot.title = element_text(size = 14, face = \"bold\"), \n        legend.position = \"top\", \n        legend.text = element_text(face = \"bold\", size = 10)) +\n  guides(color = guide_legend(nrow = 2))\n\n```  \n\n\nIn this particular case, both the IDC and Gallup forecasts were created in Q1. The chart shows the performance of each forecast. In this case, the best model is one that uses a model without Gallup daily tracking in the short term (i.e. one Quarter ahead), but does use it for future quarters (i.e. the second and third Quarters). If we isolate the Combined Gallup model and the IDC model we see that both were similar in Q1, IDC was slightly better in Q2, but Gallup's model was far better in Q3:  \n\n```{r echo = FALSE, warning = FALSE, message = FALSE}\n\nmobile_forecast_melt %>%\n  filter(!Forecast %in% c('Gallup Forecast (w/ Gallup Data)', \n                          'Gallup Forecast (w/out Gallup Data)')) %>%\n  ggplot(aes(x = Date, y = sales, group = Forecast)) +\n  geom_point(aes(color = Forecast)) +\n  geom_line(aes(color = Forecast)) +\n  xlab(\"\\nQuarter\") +\n  ylab(\"\\nForecasted Sales in Millions\\n\") +\n  ggtitle(\"\\nExample: Mobile Phone Forecast\\n\") +\n  scale_color_manual(values = gallup_palette, \"\") +\n  scale_y_continuous(labels = scales::comma) + \n    theme(plot.title = element_text(size = 14, face = \"bold\"), \n        legend.position = \"top\", \n        legend.text = element_text(face = \"bold\", size = 10))\n\n```  \n\n\nOne way to compare forecast accuracy is by calculating the **Mean Absolute Percent Error (MAPE)** of a forecast across all it's predictions. So, regardless of what direction it misses, what is the average miss made by the forecast in percentage terms.  \n\nWhen we compare the various models in this way, we find that the Combined Gallup model performs almost twice as well as IDC's model, on average:  \n\n```{r, echo=FALSE, warning=FALSE, message=FALSE}\n\nrequire(pander)\npanderOptions('table.split.table', Inf)\nmape_mobile <- data_frame(Date = c(\"2016-1\", \"2016-2\", \"2016-3\", \"MAPE\"), IDC = percent(c(.0081, .0055, .0319, .0151)), `Gallup Forecast (w/ Gallup Data)` = percent(c(.0507, .00075, .0117, .0233)), `Gallup Forecast (w/out Gallup Data)` = percent(c(.0081, .0794, .0783, .0553)), `Combined Gallup Forecast` = percent(c(.0081, .0075, .0117, .0091)))\n\nemphasize.strong.rows(which(mape_mobile == \"MAPE\"))\n\npander(mape_mobile, keep.line.breaks = TRUE)\n\n```  \n\n\n***The Accuracy-Transparency Tradeoff***\n\nOften times the most important thing about a forecast is that it is accurate. Period. There will naturally be some decrease in accuracy the farther out one tries to forecast, but generally what the client will be most interested in is the degree to which they can rely on the forecasts accuracy. \n\nHowever, in many cases the most accurate forecast will lack transparency in terms of how the models works--i.e. which variables drive the outcome being forecasted the most, and what happens if one variables changes in value?\n\nMany decision makers are used to conducting what-if analysis with their models, such that they can say \"holding other factors constant, when x increases by 10%, y will decrease by 3%\". Now, this type of general relationship can be established, but depending on the type of modeling technique we use it may be far more difficult to establish this simplistic of a relationship. Generally, there will always be some trade off between the amount of transparency and simplicity of the model and accuracy. \n\nIt is critical, therefore, to have an in depth discussion up front about what leaders value more (or, more realistically, what degree of transparency will they need to either buy into the forecasts or at least be able to use them in the way they need) so that we are able to establish the right scope as well as the proper approach to the model building process once the project begins.\n\n***One-time versus On-going***\n\n# Predictive Modeling\n\n***Description and Examples***\n\nPredictive Models are related to Forecasts, however there are some important differences when \n\n## Discrete Predictions\n\n#### Project Considerations\n\n***Data Availability***\n\n***The Accuracy-Transparency Tradeoff***\n\n***One-time versus On-going***\n\n## Likelihood/Classification Models\n\n#### Project Considerations\n\n***Data Availability***\n\n***The Accuracy-Transparency Tradeoff***\n\n***One-time versus On-going***\n\n# Hybrid Studies/Market Analysis\n\n***Description and Examples***\n\nProjects in this space tend to incorporate a mixture of different analyses. Typically the client may be interested in some type of market and they would like a better understanding of what is driving the market today and how the key drivers may change in the future, impacting what the market opportunity will evolve into.\n\n#### Project Considerations\n\n***Data Availability***\n\n***The Accuracy-Transparency Tradeoff***\n\n***One-time versus On-going***\n\n# Business Impact Analysis\n\n***Description and Examples***\n\n#### Project Considerations\n\n***Data Availability***\n\n***The Accuracy-Transparency Tradeoff***\n\n***One-time versus On-going***",
    "created" : 1482243677103.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1445158078",
    "id" : "A7BA6EF8",
    "lastKnownWriteTime" : 1482166603,
    "last_content_update" : 1482166603,
    "path" : "~/markdown_datacamp/advanced_analytics_ref_guide.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}